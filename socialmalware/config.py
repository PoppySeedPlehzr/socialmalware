import os
import multiprocessing
"""
    Configuration file for Social Malware.  This file contains
    any global variables that are shared between various classes,
    as well as helper functions used by socialmalware.py

"""
MAX_UPLOAD_SIZE = 64 * 1024 * 1024 # Limit upload size to 64MB
UPLOAD_FOLDER   = os.path.join(os.getcwd(), 'uploads/apk_samples')
SQLITE_DB       = "socialmalware.db"
VTAPIKEY        = "9724c72538581c40419b1b8e6bb4f7786af10739c8bc0cc5a4a154ee11398a1e"
LOG_FILE        = "socialmalware.log"
FIO_LOCK        = multiprocessing.Lock()

# File types that socialmalware currently supports
SUPPORTED_TYPES = set([
                        'PE32',
                        'ELF',
                        'APK'
                    ])

# Helper function to write data out to log
def LOG(s):
    FIO_LOCK.acquire()
    fout = open(LOG_FILE, 'a')
    fout.write(s+"\n")
    fout.close()
    FIO_LOCK.release()
